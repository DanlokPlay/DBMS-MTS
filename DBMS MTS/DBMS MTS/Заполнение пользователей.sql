USE MTS;
GO

-- Вставка данных в таблицу Client (Клиенты) для 67 физических и 38 юридических лиц
DECLARE @FioList TABLE (Fio NVARCHAR(100), RowNum INT);
DECLARE @CompanyList TABLE (CompanyName NVARCHAR(100), RowNum INT);

-- Добавляем ФИО физических лиц с нумерацией
INSERT INTO @FioList (Fio, RowNum)
VALUES 
('Иванов Иван Иваныч', 1),
('Петров Петр Петрович', 2),
('Сидоров Сергей Сергеевич', 3),
('Кузнецов Николай Николаевич', 4),
('Васильев Владимир Викторович', 5),
('Морозов Михаил Михайлович', 6),
('Попов Алексей Александрович', 7),
('Александров Андрей Андреевич', 8),
('Михайлов Денис Денисович', 9),
('Ковалев Максим Владимирович', 10),
('Григорьев Олег Олегович', 11),
('Чистяков Алексей Сергеевич', 12),
('Федоров Алексей Викторович', 13),
('Гусев Алексей Валерьевич', 14),
('Жуков Сергей Павлович', 15),
('Крылов Игорь Николаевич', 16),
('Тимофеев Василий Григорьевич', 17),
('Барсуков Александр Вячеславович', 18),
('Шмидт Михаил Вячеславович', 19),
('Голубев Николай Сергеевич', 20),
('Гончаров Алексей Артемович', 21),
('Дмитриев Александр Викторович', 22),
('Емельянов Кирилл Игоревич', 23),
('Зайцев Павел Сергеевич', 24),
('Ильин Дмитрий Александрович', 25),
('Калинин Андрей Васильевич', 26),
('Лавров Николай Игоревич', 27),
('Морозов Владимир Николаевич', 28),
('Новиков Дмитрий Михайлович', 29),
('Овчинников Константин Сергеевич', 30),
('Павлов Валерий Викторович', 31),
('Рыбаков Павел Валерьевич', 32),
('Смирнов Борис Евгеньевич', 33),
('Тимошенко Михаил Викторович', 34),
('Ушаков Алексей Павлович', 35),
('Фролов Николай Константинович', 36),
('Харитонов Сергей Дмитриевич', 37),
('Чернов Александр Анатольевич', 38),
('Шарапов Вячеслав Викторович', 39),
('Щербаков Владимир Григорьевич', 40),
('Анисимов Игорь Владимирович', 41),
('Белов Роман Александрович', 42),
('Воронков Владислав Артемович', 43),
('Голубев Владимир Васильевич', 44),
('Дорофеев Павел Валерьевич', 45),
('Егорова Светлана Петровна', 46),
('Жукова Татьяна Викторовна', 47),
('Захарова Наталья Анатольевна', 48),
('Королева Ольга Павловна', 49),
('Карпов Владислав Викторович', 50),
('Коваленко Виктор Александрович', 51),
('Мельников Сергей Александрович', 52),
('Соловьев Игорь Олегович', 53),
('Тимофеев Павел Анатольевич', 54),
('Борисов Александр Викторович', 55),
('Горбунов Олег Геннадьевич', 56),
('Петрова Ирина Викторовна', 57),
('Сидорова Екатерина Николаевна', 58),
('Елисеева Татьяна Валерьевна', 59),
('Ковальчук Николай Павлович', 60),
('Беляев Андрей Борисович', 61),
('Михайлова Марина Валентиновна', 62),
('Новикова Ольга Евгеньевна', 63),
('Королев Михаил Владимирович', 64),
('Степанов Сергей Анатольевич', 65),
('Тарасов Владимир Юрьевич', 66),
('Шаповалов Александр Романович', 67),
('Николаев Артем Александрович', 68),
('Андреев Илья Александрович', 69),
('Зимин Роман Викторович', 70),
('Михайлов Юрий Владимирович', 71),
('Левин Михаил Валерьевич', 72),
('Савельев Андрей Васильевич', 73),
('Гаврилов Игорь Петрович', 74),
('Волков Владислав Вячеславович', 75),
('Ефимова Лариса Анатольевна', 76),
('Захаров Николай Петрович', 77),
('Ершова Наталья Алексеевна', 78),
('Кузьмина Ольга Валентиновна', 79),
('Смирнова Екатерина Юрьевна', 80);

-- Добавляем имена для юридических лиц с нумерацией
INSERT INTO @CompanyList (CompanyName, RowNum)
VALUES
('АО "Технопарк"', 1),
('ООО "ГенезисПро"', 2),
('ООО "Мегасистемы"', 3),
('ИП "Тимофеев Михаил Александрович"', 4),
('ИП "Смирнов Владимир Иванович"', 5),
('ООО "ИнтерТех"', 6),
('АО "Глобус-Тех"', 7),
('ИП "Ковалев Алексей Владимирович"', 8),
('ООО "ПроектСистемы"', 9),
('АО "ПроектГрупп"', 10),
('ООО "ЭкспертГрупп"', 11),
('АО "ПроГрупп"', 12),
('ООО "ВекторТех"', 13),
('ООО "Вектор-Проект"', 14),
('ИП "Григорьев Олег Анатольевич"', 15),
('ИП "Петухов Петр Игоревич"', 16),
('ООО "Генерация"', 17),
('АО "ТехноГлобал"', 18),
('ООО "НоваТех"', 19),
('АО "ТехСфера"', 20),
('ООО "Глобус"', 21),
('ООО "Мир Технологий"', 22),
('ИП "Сидоров Сергей Петрович"', 23),
('ООО "ПроектСистемы"', 24),
('ИП "Смирнова Татьяна Юрьевна"', 25),
('АО "ЭкспоТех"', 26),
('ООО "НейроГрупп"', 27),
('ООО "ИнновацииТех"', 28),
('ИП "Лисенко Виктор Игоревич"', 29),
('АО "РеалТехПро"', 30),
('АО "Технодрайв"', 31),
('АО "НейроСистемы"', 32),
('ООО "Системные Решения"', 33),
('ООО "ТехСистемы"', 34),
('ООО "ПрогрессГрупп"', 35),
('ИП "Новиков Александр Валерьевич"', 36),
('АО "КосмоГрупп"', 37),
('АО "ТехноСтрим"', 38),
('ООО "ЭкспоТехГрупп"', 39),
('ООО "Альфа"', 40),
('АО "Восток"', 41),
('ИП "Григорьев Олег Анатольевич"', 42),
('АО "ТехноГрупп"', 43),
('ООО "Ракетный Комитет"', 44),
('ООО "Бизнес-Системы"', 45),
('ИП "Смирнов Владимир Иванович"', 46),
('ООО "ТехноПроект"', 47),
('ООО "МегаСтрой"', 48),
('ИП "Тимофеев Михаил Александрович"', 49),
('АО "Светлана"', 50),
('ООО "Генезис"', 51),
('АО "ЭкспоТех"', 52),
('ООО "Вектор"', 53),
('ООО "РеалТех"', 54),
('АО "ТехноСтрим"', 55),
('ООО "НейроСистемы"', 56),
('АО "ПроектГрупп"', 57),
('ООО "Глобус-Тех"', 58),
('ООО "Прогресс"', 59),
('ООО "Мировые Технологии"', 60),
('ИП "Петухов Петр Игоревич"', 61),
('ООО "Эксперт"', 62),
('АО "ГенезисПро"', 63),
('ООО "ТехноСистемы"', 64),
('АО "Глобус"', 65),
('ООО "АльтЭнерго"', 66),
('ООО "Мегасистемы"', 67),
('АО "ПроГрупп"', 68),
('ООО "Космос"', 69);

-- Вставка физических лиц
DECLARE @Counter INT = 1;
DECLARE @TariffId INT;  -- Перемещаем объявление переменной сюда
DECLARE @PhoneNumber NVARCHAR(15); -- Объявляем переменную для номера телефона один раз
DECLARE @Balance DECIMAL(15, 2);  -- Объявляем переменную для баланса только один раз

WHILE @Counter <= 67
BEGIN
    -- Генерация случайного тарифа для физического лица (не корпоративный)
    SELECT TOP 1 @TariffId = tariff_id 
    FROM Tariff 
    WHERE tariff_type = 'Некорпоративный'
    ORDER BY NEWID();  -- Выбираем случайный тариф

    -- Генерация телефонного номера (формат: 89XXXXXXXXXX)
    SET @PhoneNumber = '89' + RIGHT('000000000' + CAST(CAST(RAND() * 1000000000 AS INT) AS NVARCHAR(9)), 9);

    -- Генерация случайного баланса (может быть как положительным, так и отрицательным)
    SET @Balance = ROUND(RAND() * 900 + 100, 2);  -- Случайный баланс от 100 до 1000
    IF RAND() < 0.05  -- 5% шанс сделать баланс отрицательным
        SET @Balance = -@Balance;

    -- Вставляем клиента
    INSERT INTO Client (name, client_type, balance, phone_number, tariff_id)
    VALUES 
    ((SELECT Fio FROM @FioList WHERE RowNum = @Counter), 
     'Физическое', 
     @Balance,  -- Баланс может быть как отрицательным, так и положительным
     @PhoneNumber,
     @TariffId);

    SET @Counter = @Counter + 1;
END

-- Вставка юридических лиц
SET @Counter = 1;
WHILE @Counter <= 38
BEGIN
    -- Генерация случайного тарифа для юридического лица (корпоративный)
    SELECT TOP 1 @TariffId = tariff_id 
    FROM Tariff 
    WHERE tariff_type = 'Корпоративный'
    ORDER BY NEWID();  -- Выбираем случайный тариф

    -- Генерация телефонного номера (формат: 8916XXXXXXXX)
	SET @PhoneNumber = '89' + RIGHT('000000000' + CAST(CAST(RAND() * 1000000000 AS INT) AS NVARCHAR(9)), 9);

    -- Генерация случайного баланса для юридического лица (может быть как положительным, так и отрицательным)
    SET @Balance = ROUND(RAND() * 4000 + 1000, 2);  -- Случайный баланс для юридического лица от 1000 до 5000
    IF RAND() < 0.05  -- 5% шанс сделать баланс отрицательным
        SET @Balance = -@Balance;

    -- Вставляем клиента (юридическое лицо)
    INSERT INTO Client (name, client_type, balance, phone_number, tariff_id)
    VALUES 
    ((SELECT CompanyName FROM @CompanyList WHERE RowNum = @Counter), 
     'Юридическое', 
     @Balance,  -- Баланс может быть как отрицательным, так и положительным
     @PhoneNumber,
     @TariffId);

    SET @Counter = @Counter + 1;
END
GO